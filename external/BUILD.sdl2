load("@rules_cc//cc:defs.bzl", "cc_library")

package(
    default_visibility = ["//visibility:public"],
)

cc_library(
    name = "sdl2",
    srcs = glob(
        [
            "src/**/*.c",
            "src/**/*.h",
        ],
        exclude = [
            "src/libm/*.c",
            "src/test/*.c",
            "src/thread/generic/*.c",
            "src/render/direct3d*/**",
            "src/render/SDL_d3d*",
            "src/haptic/windows/**",
            "src/video/qnx/**",
        ],
    ),
    hdrs = [
        "include/begin_code.h",
        "include/close_code.h",
        "include/SDL.h",
        "include/SDL_assert.h",
        "include/SDL_atomic.h",
        "include/SDL_audio.h",
        "include/SDL_bits.h",
        "include/SDL_blendmode.h",
        "include/SDL_clipboard.h",
        "include/SDL_config.h",
        "include/SDL_config_macosx.h",
        "include/SDL_config_minimal.h",
        "include/SDL_cpuinfo.h",
        "include/SDL_endian.h",
        "include/SDL_error.h",
        "include/SDL_events.h",
        "include/SDL_filesystem.h",
        "include/SDL_gamecontroller.h",
        "include/SDL_gesture.h",
        "include/SDL_haptic.h",
        "include/SDL_hints.h",
        "include/SDL_joystick.h",
        "include/SDL_keyboard.h",
        "include/SDL_keycode.h",
        "include/SDL_loadso.h",
        "include/SDL_log.h",
        "include/SDL_main.h",
        "include/SDL_messagebox.h",
        "include/SDL_mouse.h",
        "include/SDL_mutex.h",
        "include/SDL_opengl.h",
        "include/SDL_opengles.h",
        "include/SDL_opengles2.h",
        "include/SDL_pixels.h",
        "include/SDL_platform.h",
        "include/SDL_power.h",
        "include/SDL_quit.h",
        "include/SDL_rect.h",
        "include/SDL_render.h",
        "include/SDL_revision.h",
        "include/SDL_rwops.h",
        "include/SDL_scancode.h",
        "include/SDL_shape.h",
        "include/SDL_stdinc.h",
        "include/SDL_surface.h",
        "include/SDL_system.h",
        "include/SDL_syswm.h",
        "include/SDL_thread.h",
        "include/SDL_timer.h",
        "include/SDL_touch.h",
        "include/SDL_version.h",
        "include/SDL_video.h",
        "include/SDL_vulkan.h",
    ],
    copts = [
        "-DHAVE_ATAN=1",
        "-DHAVE_ALLOCA_H=1",
        "-DHAVE_SYS_TYPES_H=1",
        "-DHAVE_STDIO_H=1",
        "-DSTDC_HEADERS=1",
        "-DHAVE_STDLIB_H=1",
        "-DHAVE_STDARG_H=1",
        "-DHAVE_MALLOC_H=1",
        "-DHAVE_MEMORY_H=1",
        "-DHAVE_STRING_H=1",
        "-DHAVE_STRINGS_H=1",
        "-DHAVE_INTTYPES_H=1",
        "-DHAVE_STDINT_H=1",
        "-DHAVE_CTYPE_H=1",
        "-DHAVE_MATH_H=1",
        "-DHAVE_ICONV_H=1",
        "-DHAVE_SIGNAL_H=1",
        "-DHAVE_M_PI",
        "-DHAVE_ATAN=1",
        "-DHAVE_ATAN2=1",
        "-DHAVE_ACOS=1",
        "-DHAVE_ASIN=1",
        "-DHAVE_CEIL=1",
        "-DHAVE_COPYSIGN=1",
        "-DHAVE_COS=1",
        "-DHAVE_COSF=1",
        "-DHAVE_FABS=1",
        "-DHAVE_FLOOR=1",
        "-DHAVE_LOG=1",
        "-DHAVE_POW=1",
        "-DHAVE_SCALBN=1",
        "-DHAVE_SIN=1",
        "-DHAVE_SINF=1",
        "-DHAVE_SQRT=1",
        "-DHAVE_SQRTF=1",
        "-DHAVE_TAN=1",
        "-DHAVE_TANF=1",
        "-DSDL_VIDEO_DRIVER_X11_SUPPORTS_GENERIC_EVENTS=1",
    ],
    includes = ["include"],
    linkstatic = 1,
    linkopts = [
        "-ldl",
        "-lX11",
        "-lXext",
    ],
    defines = [
        "SDL_VIDEO_DRIVER_X11",
        "SDL_TIMERS_DISABLED=0",
    ],
)
